<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.5 'PT Sans',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'PT Sans',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}ul{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:0.85rem;line-height:1.5rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:1rem;line-height:1.5rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0.9375rem;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:1.1487rem;line-height:1.5rem;border-left:0.5625rem solid #292d35;color:hsla(0,0%,0%,0.65);font-style:italic;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.5rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.5rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}li > ul{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.5rem / 2);}code{font-size:0.85rem;line-height:1.5rem;}kbd{font-size:0.85rem;line-height:1.5rem;}samp{font-size:0.85rem;line-height:1.5rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1rem;padding-right:1rem;padding-top:0.75rem;padding-bottom:calc(0.75rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}a{color:#292d35;text-decoration:none;text-shadow:.03em 0 #fff,-.03em 0 #fff,0 .03em #fff,0 -.03em #fff,.06em 0 #fff,-.06em 0 #fff,.09em 0 #fff,-.09em 0 #fff,.12em 0 #fff,-.12em 0 #fff,.15em 0 #fff,-.15em 0 #fff;background-image:linear-gradient(to top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0) 1px, #292d35 1px, #292d35 2px, rgba(0, 0, 0, 0) 2px);}a:hover,a:active{text-shadow:none;background-image:none;}h1,h2,h3,h4,h5,h6{margin-top:3rem;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.5rem;color:hsla(0,0%,0%,0.8);font-style:normal;font-weight:400;}blockquote cite:before{content:"— ";}@media only screen and (max-width:480px){html{font-size:106.25%;line-height:24.65px;}blockquote{border-left:0.28125rem solid #292d35;color:hsla(0,0%,0%,0.59);padding-left:0.84375rem;font-style:italic;margin-left:-1.125rem;margin-right:0;}}</style><style data-href="/styles.9049d68c607a167417b5.css">header h3,header h5{display:inline-block;padding-right:.5rem;margin-top:0}header a{text-shadow:none;background-image:none;text-decoration:none;vertical-align:middle}header a:hover{color:red}header a img{vertical-align:middle}.blog-list a:hover{color:#000}.blog-list h2,.blog-list h4{margin-bottom:.5rem}.blog-list h4{font-style:italic;margin-top:0}.blog-list h4 span{display:inline-block;color:grey;font-size:.8rem}.postIntro h1{font-size:2.5rem;width:100%;text-align:center;margin-top:1rem;margin-bottom:.5rem}.postIntro p.tags{font-size:.8rem;color:grey;margin:0;text-align:center}.postIntro p.date{margin:0 0 1rem;text-align:center}.postIntro p.intro{margin-top:1.5rem;font-style:italic}code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><meta name="generator" content="Gatsby 2.3.4"/><link href="//fonts.googleapis.com/css?family=Oswald:700|PT+Sans:400,400i,700" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"/><title data-react-helmet="true">Un monorepo pour les petits projets</title><meta data-react-helmet="true" name="author" content="Àlexis Janvier"/><meta data-react-helmet="true" name="description" content="Plébiscitée sur les grosses bases de code, l’utilisation d’un monorepo sur un projet de librairies est un indéniable plus. Mais qu’en est-il sur les projets plus standards ?"/><meta data-react-helmet="true" name="keywords" content="Git,Project"/><meta data-react-helmet="true" itemProp="name" content="Un monorepo pour les petits projets"/><meta data-react-helmet="true" itemProp="description" content="Plébiscitée sur les grosses bases de code, l’utilisation d’un monorepo sur un projet de librairies est un indéniable plus. Mais qu’en est-il sur les projets plus standards ?"/><meta data-react-helmet="true" itemProp="image" content="https://www.alexisjanvier.net/covers/monorepo.jpg"/><meta data-react-helmet="true" property="og:title" content="Un monorepo pour les petits projets"/><meta data-react-helmet="true" property="og:description" content="Plébiscitée sur les grosses bases de code, l’utilisation d’un monorepo sur un projet de librairies est un indéniable plus. Mais qu’en est-il sur les projets plus standards ?"/><meta data-react-helmet="true" property="og:image" content="https://www.alexisjanvier.net/covers/monorepo.jpg"/><meta data-react-helmet="true" property="og:url" content="https://www.alexisjanvier.net/monorepo"/><meta data-react-helmet="true" property="og:site_name" content="alexisjanvier.net"/><meta data-react-helmet="true" name="twitter:title" content="Un monorepo pour les petits projets"/><meta data-react-helmet="true" name="twitter:description" content="Plébiscitée sur les grosses bases de code, l’utilisation d’un monorepo sur un projet de librairies est un indéniable plus. Mais qu’en est-il sur les projets plus standards ?"/><meta data-react-helmet="true" name="twitter:image" content="https://www.alexisjanvier.net/covers/monorepo.jpg"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:image:alt" content="Un monorepo pour les petits projets"/><meta data-react-helmet="true" name="twitter:creator" content="@alexisjanvier"/><meta data-react-helmet="true" name="twitter:site" content="@alexisjanvier"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-29d252519d54cf324c4d.js"/><link as="script" rel="preload" href="/app-6c5376e06f2d7e34c5c3.js"/><link as="script" rel="preload" href="/styles-7d82cead6d54fb5cd7e1.js"/><link as="script" rel="preload" href="/1-2dea483b5ed5e468183a.js"/><link as="script" rel="preload" href="/2-0e0f7c0717f48b96baf5.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-a2347b84053fffdfabac.js"/><link as="fetch" rel="preload" href="/static/d/307/path---monorepo-ad-5-ee2-whc3jflc4U2YT0MC9tkdRtS3E.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><header><div style="margin:0 auto;max-width:1000px;padding:1.25rem 1rem"><header style="margin-bottom:1.5rem"><a href="/"><h3>This is not &#x27;Nam.</h3><h5>This is web development. There are rules.</h5></a><ul style="list-style:none;float:right"><li style="display:inline-block;margin-right:1rem"><a href="/">Blog</a></li><li style="display:inline-block;margin-right:1rem"><a href="/about/">About</a></li><li style="display:inline-block;margin-right:1rem"><a href="https://twitter.com/alexisjanvier"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAjcAAAI3AfcGRMIAAAAHdElNRQfhCQEKGCQX757NAAACjElEQVRIx62VX0hTURzHP/e6NRkYLREcrLeCfFDBGL4UiWGJL+sP9FLkQ4FR7MGHhHTe251OqRBJX6qXIBDCelCQIAYS9CSVBCsHFT3EaIIxs8HYmnp72N28/zYn+Hs653fO93Pv7/x+5/wEFatNu9Y71QBNePECSZLEhXnPYjBn3SuYAWPevMQV6my4aWac4cFkBYBSS4h+3JS3DJOMyllbgNLIHO3sbkucl1ctgJHm7df4qpADJMSe4ZgBoDTyvmo5QAJ/4S9ELfa5PcnBx5xSWwIQqhj7Jo+Fy5wRBvgBQIy/QDshLYQxb/67dvKPOEWbSZ7inPyhMHxQl72lRnHzrpAR59HBpAh5qZS4Wbr4aALcLsphIC3d5w+XeAOAOy+BMOVKrZXK5oicmHalJAZwaJ4N2YOp1sIB9ZW2nj7cIK536qruJARz8pDYxlM2APhslo+cUGdL+Lr1TlEN6FZ7X9YADMfkPhqFs/SzYD7RbT8HdmZqwEGTbjUWv8GTwlDOEiVqk5MWw6zJgVc3fSEt71oBrYaZVzQAru8qF2g2A/TWp1ysrB89br7oIvr7XcNzZWK8oTxgK2JyJI0AyPDw7lo5udLNBSsgbnA08AzBXj7tYsrijIvCvMnVrSyH7yg2dzM1yDHLmc6LnkXSJm+r2oJo3qqEkCzMtGfREcwpM9wE4Be/WeELC/In477x+n8T9NpENRPMOcAZzl/DDRxklkn5p+nLh7jKPept5BlnWHvSlFGGNOcmUVaEb3xVt/Dh4zRdOMskJSKHioBa3lb1HuttiQ45u1+PKsirYg+J6uViT7EzlNI1HMPPUpU/7y92BfT5llfpIEKmojhDhI6dvrTfzbVoe2nv/wH5+trdc83aGwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNy0wOS0wMVQxMDoyNDozNiswMjowMORVb1wAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTctMDktMDFUMTA6MjQ6MzYrMDI6MDCVCNfgAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAA10RVh0VGl0bGUAVHdpdHRlcpMAsEgAAABXelRYdFJhdyBwcm9maWxlIHR5cGUgaXB0YwAAeJzj8gwIcVYoKMpPy8xJ5VIAAyMLLmMLEyMTS5MUAxMgRIA0w2QDI7NUIMvY1MjEzMQcxAfLgEigSi4A6hcRdPJCNZUAAAAASUVORK5CYII="/></a></li><li style="display:inline-block;margin-right:1rem"><a href="https://github.com//alexisjanvier"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAjcAAAI3AfcGRMIAAAAHdElNRQfhCQEKFycJftO4AAAC2ElEQVRIx62VTUhUURTHf/c10/hJ+VH6wtqVWhi0qHEhItIiKhzbtCncRFSLWQhRJubrjTqLXAjZoqKPlVA7B0JXCUIIOqiLIkcNizRGEfxoBptpdF6LefPmOTM5Cp3NOx/3/7/3nHfPPUIjVXptq/Wag0pkZMCPnynhKRhyhlPXimQCtxxp5xr5aXgD9Fldrf4dCNQs2mgmh3/LBj10KqG0BGop/djZWZYpZoxGZTHukOJKRxVe7CyTi4O3bKTZ+zV25TAj2PF2VCWdQC3FSxkwrVQAPM7/7RRLzO2bs6yFiigWR7Vx5TuA+pIbwAJnY6ew6Ln3U2be7l4At2GsM8eYseO0BlBGv1qnhOIptGXMPSFR/WunTa+BW6bZCE9mwmuvmNfVZrcMEkTajR8XsrRkIlDWxANdzYm0g3hiW1k2rs0L5VbmHHptK8FY7QgUHpJW6023bj4zHJxhvuhq/mq9pDlMsbVdFtK4JZpDojLhF7m7JMgztEoJ2VThwj0TyBZkQCPICjMs7ZLgJ0EKKMGCHO+FLbKpoEE9kRmtXmCdTfbHLqF4NMNxU/QH9kSnpYWfY4Aiw5yV2P5AHGPCdWnH3T+Y4OC3MEWtbgQZ5DKy9l79iEcajM4qfwxglnQm6uAKySlOScKTqK0YphofUEN39DPXE+vEjegI91PgCI9UMEQgbmrd0pbUxCwAXuVNYqH2HF+ajAIFQ5IzTJ/hyI6+s36lDid3qEVTs0C9C2qOssl4GoI+Z9gCVlekyejHU+FnttstT3XrJBPkAdUM8SsFvmF1gQStfnpM7qvhb6pP9bluAqd1Xw0kEjWkp9Uff5E6GTUFDlBOuVYEokT3HOm1kTxARukEnUAJ0chCaoqaiGsrgqxtoQUaY9PBmAsdVdGBbQ/rOsMcZJDzTNJAIcVmuHTx4Sf9R+5xsMQOn26wgLJIHV1pRsq2ytNFnblb/u9wjctexvtf2qD0QeZRdFEAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTctMDktMDFUMTA6MjM6MzkrMDI6MDDwwQTMAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE3LTA5LTAxVDEwOjIzOjM5KzAyOjAwgZy8cAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAMdEVYdFRpdGxlAEdpdEh1YlTKy1sAAABXelRYdFJhdyBwcm9maWxlIHR5cGUgaXB0YwAAeJzj8gwIcVYoKMpPy8xJ5VIAAyMLLmMLEyMTS5MUAxMgRIA0w2QDI7NUIMvY1MjEzMQcxAfLgEigSi4A6hcRdPJCNZUAAAAASUVORK5CYII="/></a></li></ul></header><div><a href="https://onestla.tech/"><img src="onestlatech.jpg" alt="onestla.tech"/></a></div><div><div class="postIntro"><h1>Un monorepo pour les petits projets</h1><p class="date">Publié le <!-- -->21 février 2018</p></div><div><p>Si le terme <strong><em>monorepo</em></strong> fait très technique, il traduit parfaitement un concept simplissime : utiliser un seul repository pour plusieurs projets.</p>
<p>J’ai vu passer pas mal de posts de blog ces derniers temps sur le sujet, provenant le plus souvent de grosses boites ayant d’innombrables projets et d’innombrables développeurs, et donc d’innombrables dépôts de code. Le passage en monorepo pour ce type d’environnement est certainement très intéressant, mais très éloigné de mon quotidien.</p>
<p>Mais le principe de cette approche n’est pas une découverte : on utilise (chez Marmelab) depuis longtemps un unique repository pour gérer toutes les parties d’un même projet (une api back, une application cliente, une appli d’administration ...).</p>
<p>C’est en participant à la nouvelle version d’admin-on-rest, renommée <a href="">react-admin</a> que j’ai découvert de nouveaux outils dédiés aux monorepos. </p>
<h2>Le cas d'un projet de librairie (JavaScript)</h2>
<p>Dans le cadre d’un projet librairie, on essaye de découper le code en plusieurs petites parties pour en faciliter l’utilisation, par exemple en évitant à l’utilisateur final de charger une librairie énorme dont il n’utiliserait que quelques fonctionnalités. Mais qui dit plusieurs parties dit beaucoup d’interdépendance entre chaque partie (et l’enfer du <code class="language-text">npm link</code>) et plusieurs packages à distribuer (plusieurs repo ? :) ). </p>
<p>Sont donc apparus dans le monde du JavaScript des outils comme les <a href="https://yarnpkg.com/en/docs/workspaces">workspaces Yarn</a> ou le projet <a href="https://lernajs.io/">Lerna</a>.<br>
S'ils sont d’un indéniable intérêt pour les projets de type librairie, peuvent-ils apporter quelque chose au quotidien de projets plus classiques orientés client ?</p>
<h2>C'est quoi un "projet plus classique orienté client" ?</h2>
<p>C'est pour ma part un projet qui va requérir : </p>
<ul>
<li>une api,</li>
<li>une interface d'administration,</li>
<li>une application (web et/ou mobile) publique.</li>
</ul>
<p>En en ce moment, tout est en JavaScript. Ce qui donne peu ou prou :</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token keyword">.</span>
├── public
│   ├── admin
│   ├── api
│   └── client
├── src
│   ├── admin
<span class="token operator">|</span>   <span class="token operator">|</span>   ├── node_modules
<span class="token operator">|</span>   <span class="token operator">|</span>   ├── package.json
<span class="token operator">|</span>   <span class="token operator">|</span>   └── index.js
│   ├── api
<span class="token operator">|</span>   <span class="token operator">|</span>   ├── node_modules
<span class="token operator">|</span>   <span class="token operator">|</span>   ├── package.json
<span class="token operator">|</span>   <span class="token operator">|</span>   └── index.js
│   └── client
<span class="token operator">|</span>       ├── node_modules
<span class="token operator">|</span>       ├── package.json
<span class="token operator">|</span>       └── index.js
├── .gitignore
├── README.md
└── makefile</code></pre></div>
<p>On a un répertoire <code class="language-text">public</code> pour les builds finaux, un répertoire <code class="language-text">src</code> dans lequel on retrouve les trois "projets", chacun gérant ses dépendances (parfois les mêmes). Un <code class="language-text">makefile</code> à la racine permet de lancer par exemple l'installation des dépendances des trois projets.</p>
<div class="gatsby-highlight" data-language="makefile"><pre class="language-makefile"><code class="language-makefile">// in makefile

<span class="token symbol">install-admin</span><span class="token punctuation">:</span>
	cd src/admin &amp;&amp; yarn install

<span class="token symbol">install-api</span><span class="token punctuation">:</span>
	cd src/api &amp;&amp; yarn install

<span class="token symbol">install-client</span><span class="token punctuation">:</span>
	cd src/client &amp;&amp; yarn install

<span class="token symbol">install</span><span class="token punctuation">:</span> install-admin install-api install-client</code></pre></div>
<br />
<blockquote>
<p>Du coup, les outils développés pour une approche monorepo peuvent-ils améliorer cette manière d'organiser mon code ?</p>
</blockquote>
<h2>Yarn workspace</h2>
<p>Les workspaces yarn sont disponibles depuis la version <code class="language-text">1.0</code>. L'utilisation de ces workspaces va permettre de déclarer un <code class="language-text">package.json</code> <em>parent</em> dans lequel on va indiquer à yarn où sont nos <code class="language-text">package.json</code> <em>enfants</em> (ceux de nos trois projets). Yarn pourra ainsi se débrouiller depuis la racine du projet pour installer toutes les dépendances, et surtout mettre toutes celles communes dans un même répertoire node_modules à la racine du projet: c'est de l'espace disque et du temps d'installation de gagnés.</p>
<p>Voici à quoi ressemble le package.json à la racine du site :</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"workspaces"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">"src/*"</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>Les autres fichiers package.json n'ont pas à être modifiés.</strong></p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token keyword">.</span>
├── node_modules
├── public
│   ├── admin
│   ├── api
│   └── client
├── src
│   ├── admin
<span class="token operator">|</span>   <span class="token operator">|</span>   ├── node_modules
<span class="token operator">|</span>   <span class="token operator">|</span>   ├── package.json
<span class="token operator">|</span>   <span class="token operator">|</span>   └── index.js
│   ├── api
<span class="token operator">|</span>   <span class="token operator">|</span>   ├── node_modules
<span class="token operator">|</span>   <span class="token operator">|</span>   ├── package.json
<span class="token operator">|</span>   <span class="token operator">|</span>   └── index.js
│   └── client
<span class="token operator">|</span>       ├── node_modules
<span class="token operator">|</span>       ├── package.json
<span class="token operator">|</span>       └── index.js
├── .gitignore
├── package.json
├── README.md
└── makefile</code></pre></div>
<p>Pour reprendre mon exemple précédent, l'installation du projet global prenait 333 Mo sur le disque. </p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">~/Code/sideprojects
❯ <span class="token function">du</span> -hs seamanship
333M    seamanship</code></pre></div>
<p>Avec la mise en place des workspaces, le projet global ne prend plus que 186 Mo.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">~/Code/sideprojects
❯ <span class="token function">du</span> -hs seamanship
186M    seamanship</code></pre></div>
<p><strong><em>Remarque</em></strong>: <em>lors de mes tests, les parties <code class="language-text">admin</code> et <code class="language-text">client</code> étaient bootstrappées avec <code class="language-text">create-react-app</code>. Il a donc fallu que je crée mes deux répertoires avec un <code class="language-text">create-react-app admin</code> et <code class="language-text">create-react-app client</code> depuis <code class="language-text">src</code>, ensuite que je supprime le <code class="language-text">yarn.lock</code> et le répertoire <code class="language-text">node_modules</code> des deux parties, pour enfin relancer un <code class="language-text">yarn install</code> depuis la racine du projet afin de profiter des workspaces.</em></p>
<p><strong><em>Tips</em></strong>: <em>Pour installer un nouveau composant dans un des workspaces, on peut lancer un <code class="language-text">yarn add</code> depuis le répertoire du workspace, ou alors plus pratique, depuis la racine du projet :</em></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">yarn workspace workspaceNameInPackageJson add componantName</code></pre></div>
<h2>Code styling</h2>
<p>Les workspace permettent de facilement mutualiser les dépendances entre les différentes parties d'un projet. Mais peut-on les utiliser pour gérer d'autres problématiques communes, comme la gestion du code styling ? </p>
<p>Essayons d'installer eslint à la racine du projet :</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">~/Code/sideprojects/seamanship master*
❯ <span class="token function">yarn</span> <span class="token function">add</span> eslint
<span class="token function">yarn</span> <span class="token function">add</span> v1.3.2
error Running this <span class="token function">command</span> will <span class="token function">add</span> the dependency to the workspace root rather than workspa
ce itself, <span class="token function">which</span> might not be what you want - <span class="token keyword">if</span> you really meant it, <span class="token function">make</span> it explicit by ru
nning this <span class="token function">command</span> again with the -W flag <span class="token punctuation">(</span>or --ignore-workspace-root-check<span class="token punctuation">)</span>.
info Visit https://yarnpkg.com/en/docs/cli/add <span class="token keyword">for</span> documentation about this command.</code></pre></div>
<p>Comme c'est vraiment ce que l'on veut, lançons donc :</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> <span class="token function">add</span> -DW eslint prettier eslint-plugin-prettier eslint-config-prettier</code></pre></div>
<p>Et tout se déroule normalement \o/.</p>
<h2>Les tests</h2>
<p>Il reste encore une problématique à aborder dans cette rapide exploration des outils liés aux monorepos : peut-on simplifier le lancement de l'intégralité des <strong>tests</strong> du projet ?     </p>
<p>Depuis sa version 20, Jest est capable de <a href="https://facebook.github.io/jest/docs/en/configuration.html#projects-array-string-projectconfig">lancer en parallèle les tests sur plusieurs projets</a> :</p>
<p><img src="/images/monorepo/20-multi-runner.gif" alt="Jest Multi-Project-Runner"></p>
<p>Pas de chance pour mon exploration qui se base sur deux applications <em>create-react-app</em>, <a href="https://github.com/facebook/create-react-app/issues/2461">elles ne sont pas compatible avec cette fonctionnalité</a> :( </p>
<p>Il me faudra donc passer comme avant avant par un <code class="language-text">makefile</code></p>
<div class="gatsby-highlight" data-language="makefile"><pre class="language-makefile"><code class="language-makefile">// in makefile

<span class="token symbol">test-admin</span><span class="token punctuation">:</span>
	cd services/administration &amp;&amp; NODE_ENV<span class="token operator">=</span><span class="token string">"test"</span> CI<span class="token operator">=</span>true yarn test

<span class="token symbol">test-configurator</span><span class="token punctuation">:</span>
	cd services/configurator &amp;&amp; NODE_ENV<span class="token operator">=</span><span class="token string">"test"</span> CI<span class="token operator">=</span>true yarn test

<span class="token symbol">test</span><span class="token punctuation">:</span> test-admin test-configurator</code></pre></div>
<h3>Lerna</h3>
<p>Avant de conclure, j'ajouterais quelques mots sur un projet cité en introduction: <a href="https://lernajs.io/">Lerna</a>.<br>
Lerna est un outil qui permet principalement de <strong>partager</strong> du code au sein d'un monorepo.   </p>
<p>Imaginons une librairie que l'on a divisé un plusieures parties, avec un <em>core</em> commun et des fonctionnalitées séparées en packages distincts. Chaque package va dépendre du <em>core</em>.</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token comment">// in packages/ra-core/package.json du projet react-admin</span>
<span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ra-core"</span><span class="token punctuation">,</span>
    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"2.0.0-beta2"</span><span class="token punctuation">,</span>
	...
<span class="token punctuation">}</span></code></pre></div>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token comment">// in packages/react-admin/package.json du projet react-admin</span>
<span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"react-admin"</span><span class="token punctuation">,</span>
    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"2.0.0-beta2"</span><span class="token punctuation">,</span>
    ...
    <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"ra-language-english"</span><span class="token operator">:</span> <span class="token string">"^2.0.0-beta2"</span><span class="token punctuation">,</span>
        <span class="token property">"ra-core"</span><span class="token operator">:</span> <span class="token string">"^2.0.0-beta2"</span><span class="token punctuation">,</span>
        <span class="token property">"ra-ui-materialui"</span><span class="token operator">:</span> <span class="token string">"^2.0.0-beta2"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Maintenant, si l'on modifie le <em>core</em>, il faudrait le publier pour pouvoir le tester au sein des autres packages !<br>
Lerna va permettre d'utiliser le code du <em>core</em> présent dans le monorepo comme un package déja publié. C'est ce que fait <code class="language-text">npm link</code> mais Lerna le fait mieux, et plus simplement.</p>
<p>Dans notre cas - celui d'un petit projet - on ne partage que des fonctionnalités entre nos différentes parties du dépôt, pas de code ! Lerna n'a donc pas d'intérêt (ou en tout cas, je ne l'ai pas vu).   </p>
<p>Par contre, dès lors que l'on va avoir besoin d'isoler du code commun entre plusieurs de ces parties du projet, par exemple un *style guide** utilisé par une appli web et une appli mobile, Lerna prendra tout son sens.</p>
<h2>Conclusion</h2>
<p>L’utilisation d’un monorepo pour gérer un projet client est une évidence quand bien même les différentes parties du projet (api, front, mobile) seraient sur des technos différentes.</p>
<p>Dans ce cadre et si plus d’une des parties est basée sur JavaScript, l’utilisation des workspaces Yarn, sans apporter énormément, permet de gagner de l’espace disque et du temps d’installation. C’est déjà ça.<br>
Des outils plus classiques (Eslint, Jest) se prêtent également bien à ce mode de gestion du code.</p>
<p>Les monorepos ne sont pas une révolution donc, mais une évolution positive vers une meilleure gestion de notre quotidien de développeur.</p></div><div class="just-comments" data-apikey="cdfe5295-0bb5-4662-b98b-11fcfc0eaa83"></div></div></div></header></div></div><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-129388047-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-129388047-1', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"monorepo-ad5","path":"/monorepo"};window.dataPath="307/path---monorepo-ad-5-ee2-whc3jflc4U2YT0MC9tkdRtS3E";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-6c5376e06f2d7e34c5c3.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-a2347b84053fffdfabac.js"],"component---src-pages-about-js":["/component---src-pages-about-js-50280528ba021d293c7e.js"],"component---src-pages-index-js":["/component---src-pages-index-js-55243eec3c450467d273.js"],"pages-manifest":["/pages-manifest-f93a4abd6189ec61c40e.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-a2347b84053fffdfabac.js" async=""></script><script src="/2-0e0f7c0717f48b96baf5.js" async=""></script><script src="/1-2dea483b5ed5e468183a.js" async=""></script><script src="/styles-7d82cead6d54fb5cd7e1.js" async=""></script><script src="/app-6c5376e06f2d7e34c5c3.js" async=""></script><script src="/webpack-runtime-29d252519d54cf324c4d.js" async=""></script></body></html>