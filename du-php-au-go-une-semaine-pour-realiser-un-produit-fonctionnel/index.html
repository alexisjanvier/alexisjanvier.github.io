<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/0.08eb512c534233bffd38.css">code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><style data-href="/component---src-templates-blog-post-js.8561d3a56fd02900d3af.css">header h3,header h5{display:inline-block;padding-right:.5rem;margin-top:0}header a{text-shadow:none;background-image:none;text-decoration:none;vertical-align:middle}header a:hover{color:red}header a img{vertical-align:middle}.blog-list a:hover{color:#000}.blog-list h2,.blog-list h4{margin-bottom:.5rem}.blog-list h4{font-style:italic;margin-top:0}.blog-list h4 span{display:inline-block;color:grey;font-size:.8rem}.postIntro h1{font-size:2.5rem;width:100%;text-align:center;margin-top:1rem;margin-bottom:.5rem}.postIntro p.tags{font-size:.8rem;color:grey;margin:0;text-align:center}.postIntro p.date{margin:0 0 1rem;text-align:center}.postIntro p.intro{margin-top:1.5rem;font-style:italic}</style><meta name="generator" content="Gatsby 2.0.50"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.5 'PT Sans',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'PT Sans',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;color:hsla(0,0%,0%,0.9);font-family:'Oswald',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}ul{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.5rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:0.85rem;line-height:1.5rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:1rem;line-height:1.5rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0.9375rem;padding-right:0;padding-top:0;margin-bottom:1.5rem;font-size:1.1487rem;line-height:1.5rem;border-left:0.5625rem solid #292d35;color:hsla(0,0%,0%,0.65);font-style:italic;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.5rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.5rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}li > ul{margin-left:1.5rem;margin-bottom:calc(1.5rem / 2);margin-top:calc(1.5rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.5rem / 2);}code{font-size:0.85rem;line-height:1.5rem;}kbd{font-size:0.85rem;line-height:1.5rem;}samp{font-size:0.85rem;line-height:1.5rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1rem;padding-right:1rem;padding-top:0.75rem;padding-bottom:calc(0.75rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}a{color:#292d35;text-decoration:none;text-shadow:.03em 0 #fff,-.03em 0 #fff,0 .03em #fff,0 -.03em #fff,.06em 0 #fff,-.06em 0 #fff,.09em 0 #fff,-.09em 0 #fff,.12em 0 #fff,-.12em 0 #fff,.15em 0 #fff,-.15em 0 #fff;background-image:linear-gradient(to top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0) 1px, #292d35 1px, #292d35 2px, rgba(0, 0, 0, 0) 2px);}a:hover,a:active{text-shadow:none;background-image:none;}h1,h2,h3,h4,h5,h6{margin-top:3rem;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.5rem;color:hsla(0,0%,0%,0.8);font-style:normal;font-weight:400;}blockquote cite:before{content:"— ";}@media only screen and (max-width:480px){html{font-size:106.25%;line-height:24.65px;}blockquote{border-left:0.28125rem solid #292d35;color:hsla(0,0%,0%,0.59);padding-left:0.84375rem;font-style:italic;margin-left:-1.125rem;margin-right:0;}}</style><link href="//fonts.googleapis.com/css?family=Oswald:700|PT+Sans:400,400i,700" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://assets-cdn.github.com/assets/gist-embed-87673c31a5b37b5e6556b63e1081ebbc.css"/><title data-react-helmet="true">Du PHP au Go: une semaine pour réaliser un produit fonctionnel</title><meta data-react-helmet="true" name="author" content="Àlexis Janvier"/><meta data-react-helmet="true" name="description" content="Du PHP au Go: une semaine pour réaliser un produit fonctionnel "/><meta data-react-helmet="true" name="keywords" content="go"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/app-e52548c910bf279cf6bf.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-89c9301d375323c8ec10.js"/><link as="script" rel="preload" href="/1-e509a756d46a154ce9c5.js"/><link as="script" rel="preload" href="/0-2015668eb1773c4165d8.js"/><link as="script" rel="preload" href="/webpack-runtime-589ef60f67b8dea36f2b.js"/><link rel="preload" href="/static/d/936/path---du-php-au-go-une-semaine-pour-realiser-un-produit-fonctionnel-757-717-9VYWa0YqnWzJpo2Qcawjmbu7K6c.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><header><div style="margin:0 auto;max-width:1000px;padding:1.25rem 1rem"><header style="margin-bottom:1.5rem"><a href="/"><h3>This is not &#x27;Nam.</h3><h5>This is my blog. There are rules.</h5></a><ul style="list-style:none;float:right"><li style="display:inline-block;margin-right:1rem"><a href="/">Blog</a></li><li style="display:inline-block;margin-right:1rem"><a href="/about/">About</a></li><li style="display:inline-block;margin-right:1rem"><a href="https://twitter.com/alexisjanvier"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAjcAAAI3AfcGRMIAAAAHdElNRQfhCQEKGCQX757NAAACjElEQVRIx62VX0hTURzHP/e6NRkYLREcrLeCfFDBGL4UiWGJL+sP9FLkQ4FR7MGHhHTe251OqRBJX6qXIBDCelCQIAYS9CSVBCsHFT3EaIIxs8HYmnp72N28/zYn+Hs653fO93Pv7/x+5/wEFatNu9Y71QBNePECSZLEhXnPYjBn3SuYAWPevMQV6my4aWac4cFkBYBSS4h+3JS3DJOMyllbgNLIHO3sbkucl1ctgJHm7df4qpADJMSe4ZgBoDTyvmo5QAJ/4S9ELfa5PcnBx5xSWwIQqhj7Jo+Fy5wRBvgBQIy/QDshLYQxb/67dvKPOEWbSZ7inPyhMHxQl72lRnHzrpAR59HBpAh5qZS4Wbr4aALcLsphIC3d5w+XeAOAOy+BMOVKrZXK5oicmHalJAZwaJ4N2YOp1sIB9ZW2nj7cIK536qruJARz8pDYxlM2APhslo+cUGdL+Lr1TlEN6FZ7X9YADMfkPhqFs/SzYD7RbT8HdmZqwEGTbjUWv8GTwlDOEiVqk5MWw6zJgVc3fSEt71oBrYaZVzQAru8qF2g2A/TWp1ysrB89br7oIvr7XcNzZWK8oTxgK2JyJI0AyPDw7lo5udLNBSsgbnA08AzBXj7tYsrijIvCvMnVrSyH7yg2dzM1yDHLmc6LnkXSJm+r2oJo3qqEkCzMtGfREcwpM9wE4Be/WeELC/In477x+n8T9NpENRPMOcAZzl/DDRxklkn5p+nLh7jKPept5BlnWHvSlFGGNOcmUVaEb3xVt/Dh4zRdOMskJSKHioBa3lb1HuttiQ45u1+PKsirYg+J6uViT7EzlNI1HMPPUpU/7y92BfT5llfpIEKmojhDhI6dvrTfzbVoe2nv/wH5+trdc83aGwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNy0wOS0wMVQxMDoyNDozNiswMjowMORVb1wAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTctMDktMDFUMTA6MjQ6MzYrMDI6MDCVCNfgAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAA10RVh0VGl0bGUAVHdpdHRlcpMAsEgAAABXelRYdFJhdyBwcm9maWxlIHR5cGUgaXB0YwAAeJzj8gwIcVYoKMpPy8xJ5VIAAyMLLmMLEyMTS5MUAxMgRIA0w2QDI7NUIMvY1MjEzMQcxAfLgEigSi4A6hcRdPJCNZUAAAAASUVORK5CYII="/></a></li><li style="display:inline-block;margin-right:1rem"><a href="https://github.com//alexisjanvier"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAjcAAAI3AfcGRMIAAAAHdElNRQfhCQEKFycJftO4AAAC2ElEQVRIx62VTUhUURTHf/c10/hJ+VH6wtqVWhi0qHEhItIiKhzbtCncRFSLWQhRJubrjTqLXAjZoqKPlVA7B0JXCUIIOqiLIkcNizRGEfxoBptpdF6LefPmOTM5Cp3NOx/3/7/3nHfPPUIjVXptq/Wag0pkZMCPnynhKRhyhlPXimQCtxxp5xr5aXgD9Fldrf4dCNQs2mgmh3/LBj10KqG0BGop/djZWZYpZoxGZTHukOJKRxVe7CyTi4O3bKTZ+zV25TAj2PF2VCWdQC3FSxkwrVQAPM7/7RRLzO2bs6yFiigWR7Vx5TuA+pIbwAJnY6ew6Ln3U2be7l4At2GsM8eYseO0BlBGv1qnhOIptGXMPSFR/WunTa+BW6bZCE9mwmuvmNfVZrcMEkTajR8XsrRkIlDWxANdzYm0g3hiW1k2rs0L5VbmHHptK8FY7QgUHpJW6023bj4zHJxhvuhq/mq9pDlMsbVdFtK4JZpDojLhF7m7JMgztEoJ2VThwj0TyBZkQCPICjMs7ZLgJ0EKKMGCHO+FLbKpoEE9kRmtXmCdTfbHLqF4NMNxU/QH9kSnpYWfY4Aiw5yV2P5AHGPCdWnH3T+Y4OC3MEWtbgQZ5DKy9l79iEcajM4qfwxglnQm6uAKySlOScKTqK0YphofUEN39DPXE+vEjegI91PgCI9UMEQgbmrd0pbUxCwAXuVNYqH2HF+ajAIFQ5IzTJ/hyI6+s36lDid3qEVTs0C9C2qOssl4GoI+Z9gCVlekyejHU+FnttstT3XrJBPkAdUM8SsFvmF1gQStfnpM7qvhb6pP9bluAqd1Xw0kEjWkp9Uff5E6GTUFDlBOuVYEokT3HOm1kTxARukEnUAJ0chCaoqaiGsrgqxtoQUaY9PBmAsdVdGBbQ/rOsMcZJDzTNJAIcVmuHTx4Sf9R+5xsMQOn26wgLJIHV1pRsq2ytNFnblb/u9wjctexvtf2qD0QeZRdFEAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTctMDktMDFUMTA6MjM6MzkrMDI6MDDwwQTMAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE3LTA5LTAxVDEwOjIzOjM5KzAyOjAwgZy8cAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAMdEVYdFRpdGxlAEdpdEh1YlTKy1sAAABXelRYdFJhdyBwcm9maWxlIHR5cGUgaXB0YwAAeJzj8gwIcVYoKMpPy8xJ5VIAAyMLLmMLEyMTS5MUAxMgRIA0w2QDI7NUIMvY1MjEzMQcxAfLgEigSi4A6hcRdPJCNZUAAAAASUVORK5CYII="/></a></li></ul></header><div><div class="postIntro"><h1>Du PHP au Go: une semaine pour réaliser un produit fonctionnel</h1><p class="date">Publié le <!-- -->22 septembre 2014</p></div><div><img src="/images/blog/go-by-practice.png">
<p>Fraichement arrivé chez Marmelab, ma mission actuelle constiste à produire un applicatif par semaine, sur une techno inconnue, avec une bonne qualité de code (tests unitaires, réutilisabilité) et un produit fonctionnel à la fin. Il s'agit de s'accoutumer au mantra <em>« learn fast, fail fast, and recover fast. »</em> (voir <a href="http://marmelab.com/blog/2014/09/01/one-new-tech-per-project.html">One New Tech Per Project</a>). Si ma première semaine était plutôt <em>fail fast</em> (elle s'est terminée sans produit fonctionnel), ma seconde semaine m'a semblée plutôt <em>learn fast</em>. La mission consistait à réaliser un webservice lié à Github et aux Pull Requests, en Go. Cette première approche pratique d'un langage typé et compilé fut un réel plaisir, tant Go semble respecter son engagement à rendre facile l'écriture de programmes simples, fiables et efficaces. Voici quelques éléments de feedback.</p>
<h2>Mise en place d'un webservice</h2>
<p>Les fonctionnalités du Go sont étendues via des packages, le langage étant livré de base avec une boite à outils conséquente (la « <a href="http://golang.org/pkg/">standard library</a> »). Même si google retourne très rapidement des résultats sur des packages destinés à la mise en place de serveurs web (<a href="http://www.gorillatoolkit.org/pkg/mux">mux</a>, <a href="http://martini.codegangsta.io/">Martini</a>), on trouve dans la librairie standard un excellent package dédié, le package <a href="http://golang.org/pkg/net/http/">http</a>.</p>
<div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"fmt"</span>
    <span class="token string">"net/http"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">handler</span><span class="token punctuation">(</span>response http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> request <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token string">"Hi there, I love %s!"</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
    http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Avec 15 lignes de code (simple, fiable et efficace), on dispose d'un serveur web qui, une fois compilé, pourra être exécuté sans dépendances (pas de node à installer) aussi bien sur Linux que sur Osx ou Windows. Pour quelqu'un venant du Php, je trouve cela « magique ».</p>
<p>Mieux encore, Go est fourni avec un package permettant d'exécuter des tests (nativement) et même un package dédié aux tests http (le package <a href="http://golang.org/pkg/net/http/httptest/">httptest</a>). La côté fiable du langage est pris au sérieux.</p>
<h2>Go Playground</h2>
<p>Peut-être plus anecdotique, on dispose sur le site de Golang d'une interface permettant d'exécuter et de partager du code Go: le <a href="http://play.golang.org">Go Playground</a>. Certes, on trouve l'équivalent pour d'autres technologies sur des sites comme <a href="http://codepen.io">CodePen</a>, mais c'est réjouissant de retrouver ce service pour Go, supporté directement par l'équipe du langage. De plus, contrairement à du javascript, le Go est un langage compilé : la mise en place d'un tel service était certainement moins évidente. Elle est rendue possible entre autres par la vitesse de compilation du langage : c'est vraiment très, très rapide. Lors du développement cette phase que l'on trolle si facilement sur du .NET est presque transparente.</p>
<p>Pour conclure sur le Go Playground, c'est un outil génial pour apprendre, mais également pour faire du code review ou du peer programming à distance.</p>
<h2>Closures et structures de test et de boucle</h2>
<p>Sans aborder ici la syntaxe spécifique du Go concernant les structures de test (<code class="language-text">if</code> et <code class="language-text">switch</code>) ou de boucle (<code class="language-text">for</code> uniquement), un point m'a déconcerté lors de l'utilisation de ces structures : toutes les variables déclarées dans un <code class="language-text">if</code> ou un <code class="language-text">for</code> ne sont visibles qu'en leur sein. On est dans une closure.</p>
<p>L'exemple suivant provoque une erreur</p>
<div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> greeting <span class="token operator">:=</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">len</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> say <span class="token builtin">string</span>
    say <span class="token operator">=</span> <span class="token string">"Hello !"</span>

    <span class="token keyword">return</span> say
<span class="token punctuation">}</span></code></pre></div>
<p><a href="http://play.golang.org/p/adulEdo8VS">http://play.golang.org/p/adulEdo8VS</a></p>
<p>Pour que cela fonctionne, il faut faire :</p>
<div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> greeting <span class="token builtin">string</span>
    <span class="token keyword">if</span> greeting <span class="token operator">=</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">len</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> say <span class="token builtin">string</span>
    say <span class="token operator">=</span> <span class="token string">"Hello !"</span>

    <span class="token keyword">return</span> say
<span class="token punctuation">}</span></code></pre></div>
<p><a href="http://play.golang.org/p/i0m_Mrc7ca">http://play.golang.org/p/i0m_Mrc7ca</a></p>
<p>L'exemple ici est très simple, mais j'ai été confronté à des cas un peu plus compliqués, du moins pour une première découverte du langage.</p>
<p>Par exemple, le code suivant renvoie une erreur:</p>
<div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">type</span> Tag <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Name <span class="token builtin">string</span>
    Sha <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Branch <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Name <span class="token builtin">string</span>
<span class="token punctuation">}</span>


<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    testVar <span class="token operator">:=</span> <span class="token string">"tag"</span>
    <span class="token keyword">if</span> testVar <span class="token operator">==</span> <span class="token string">"tag"</span> <span class="token punctuation">{</span>
        base<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">fetchTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        base<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">fetchBranch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"error : %v\n"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>base<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">fetchTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Tag<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    tag <span class="token operator">:=</span> Tag<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">"v1"</span><span class="token punctuation">,</span> Sha<span class="token punctuation">:</span> <span class="token string">"2b55d21f91309cf5ca17bcb827a0ddbd1de81d18"</span><span class="token punctuation">}</span>

    <span class="token keyword">return</span> tag<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">fetchBranch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Branch<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    branch <span class="token operator">:=</span> Branch<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">"master"</span><span class="token punctuation">}</span>

    <span class="token keyword">return</span> branch<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span></code></pre></div>
<p><a href="http://play.golang.org/p/FT32xqpp8t">http://play.golang.org/p/FT32xqpp8t</a></p>
<p>Il faut plutôt faire:</p>
<div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">type</span> Tag <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Name <span class="token builtin">string</span>
    Sha <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Branch <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Name <span class="token builtin">string</span>
<span class="token punctuation">}</span>


<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    testVar <span class="token operator">:=</span> <span class="token string">"tag"</span>
    <span class="token keyword">var</span> name <span class="token builtin">string</span>
    <span class="token keyword">var</span> err <span class="token builtin">error</span>
    <span class="token keyword">if</span> testVar <span class="token operator">==</span> <span class="token string">"tag"</span> <span class="token punctuation">{</span>
        tag<span class="token punctuation">,</span> errTag <span class="token operator">:=</span> <span class="token function">fetchTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        name <span class="token operator">=</span> tag<span class="token punctuation">.</span>Name
        err <span class="token operator">=</span> errTag
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        branch<span class="token punctuation">,</span> errBranch <span class="token operator">:=</span> <span class="token function">fetchBranch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        name <span class="token operator">=</span> branch<span class="token punctuation">.</span>Name
        err <span class="token operator">=</span> errBranch
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"error : %v\n"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">fetchTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Tag<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    tag <span class="token operator">:=</span> Tag<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">"v1"</span><span class="token punctuation">,</span> Sha<span class="token punctuation">:</span> <span class="token string">"2b55d21f91309cf5ca17bcb827a0ddbd1de81d18"</span><span class="token punctuation">}</span>

    <span class="token keyword">return</span> tag<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">fetchBranch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Branch<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    branch <span class="token operator">:=</span> Branch<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">"master"</span><span class="token punctuation">}</span>

    <span class="token keyword">return</span> branch<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span></code></pre></div>
<p><a href="http://play.golang.org/p/KGNf-KAINg">http://play.golang.org/p/KGNf-KAINg</a></p>
<p>Une autre solution consisterait à utiliser les interfaces du Go, très différentes de la notion d'interface d'un langage comme le PHP.</p>
<h2>Persistance avec MongoDb</h2>
<p>Le projet sur lequel je travaillais nécessitait du stockage et je me suis vite orienté vers du MongoDb (phase de découverte de techno oblige). Cette fois-ci, pas de package dans la librairie standard, mais un package apparaît très rapidement lors d'une recherche web (et pas 20 packages différents) : <a href="https://labix.org/mgo">mgo</a>.</p>
<p>Imaginons un objet <code class="language-text">adress</code> qu'il faut sauvegarder. Nous allons définir un type <code class="language-text">Adress</code> et complèter la définition de ses différents attributs avec la syntaxe <code class="language-text">bson:&quot;nom_mongodb&quot;</code>. Le <code class="language-text">BSON</code> est le format binaire utilisé par MongoDb pour le stockage du <code class="language-text">JSON</code>.</p>
<div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">type</span> Adress <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Street       <span class="token builtin">string</span>      <span class="token string">`bson:"street"`</span>
    PostalCode   <span class="token builtin">string</span>      <span class="token string">`bson:"postal_code"`</span>
    City         <span class="token builtin">string</span>      <span class="token string">`bson:"city"`</span>
    DoorCode     <span class="token builtin">int</span>         <span class="token string">`bson:"-"`</span>
<span class="token punctuation">}</span></code></pre></div>
<p>De cette manière, le package mgo va pouvoir facilement transformer une variable de type <code class="language-text">Adress</code> en objet bson sauvegardable dans MongoDb. Et inversemment, un objet bson requêté depuis MongoDb sera transformé en variable de type <code class="language-text">Adress</code> dans le code Go.
Rapide, simple et efficace.</p>
<div class="tips">
<p>si l'on ne veut pas qu'un attribut soit transformé en bson pour être stocké, il suffit d'indiquer <code class="language-text">bson:&quot;-&quot;</code>.</p>
</div>
<h2>Une bonne documentation, parfois en manque d'exemples</h2>
<p>On trouve un utilitaire permettant de générer la documentation d'un package depuis le code : <a href="https://godoc.org/code.google.com/p/go.tools/cmd/godoc">gocode</a>. La documentation peut être affichée sur la console, mais godoc peut également lancer un serveur web pour consulter cette documentation depuis un navigateur.</p>
<p>En règle générale, tous les packages de la librairie standard sont très bien documentés, même s'ils manquent parfois d'exemples pratiques.
Je pense ici au package <a href="http://golang.org/pkg/time/">time</a>, via lequel j'avais besoin de soustraire 2 semaines à une date donnée. On trouve dans la documentation une fonction Add() et une fonction Truncate(), mais pas d'exemples. Et bien pour retirer 2 semaines à une date il faut utiliser Add() avec une <code class="language-text">duration</code> négative.</p>
<div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    now <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span>
    twoWeeksAgo <span class="token operator">:=</span> now<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token number">7</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Hour<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>twoWeeksAgo<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p><a href="http://play.golang.org/p/kkF7G7yLfF">http://play.golang.org/p/kkF7G7yLfF</a></p>
<p>Merci <a href="https://twitter.com/manuquentin">@manuquentin</a>, parfois (souvent, toujours) les collègues sont la meilleure documentation du monde.</p>
<h2>Tout ce que je n'ai pas abordé en une semaine</h2>
<p>Je suis très loin d'avoir vu toutes les subtilités de Go lors de cette semaine : les tableaux de bits, les runes et les slices me réservent encore beaucoup d'étonnement. Je m'attends à être piègé par des pointeurs hasardeux. Je regrette de n'avoir pas encore utilisé les <a href="http://golang.org/doc/effective_go.html#goroutines">Goroutines</a> qui constituent paraît-il l'un des atouts du Go. Mais je suis positivement étonné par la rapidité avec laquelle on peut produire du code fiable, rapide, multitâches et  multi-environnements. Au point où je rajouterais bien sur mon pc un sticker de gopher à mon éléphant.</p></div></div></div></header></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"du-php-au-go-une-semaine-pour-realiser-un-produit-fonctionnel-757","path":"/du-php-au-go-une-semaine-pour-realiser-un-produit-fonctionnel"};window.dataPath="936/path---du-php-au-go-une-semaine-pour-realiser-un-produit-fonctionnel-757-717-9VYWa0YqnWzJpo2Qcawjmbu7K6c";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-e52548c910bf279cf6bf.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js.8561d3a56fd02900d3af.css","/component---src-templates-blog-post-js-89c9301d375323c8ec10.js"],"component---src-pages-about-js":["/component---src-pages-about-js.8561d3a56fd02900d3af.css","/component---src-pages-about-js-c7a05c0bd6266cf25df7.js"],"component---src-pages-index-js":["/component---src-pages-index-js.8561d3a56fd02900d3af.css","/component---src-pages-index-js-007dbffb3c05ad14e88d.js"]};/*]]>*/</script><script src="/webpack-runtime-589ef60f67b8dea36f2b.js" async=""></script><script src="/0-2015668eb1773c4165d8.js" async=""></script><script src="/1-e509a756d46a154ce9c5.js" async=""></script><script src="/component---src-templates-blog-post-js-89c9301d375323c8ec10.js" async=""></script><script src="/app-e52548c910bf279cf6bf.js" async=""></script></body></html>